<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8">
</head>
<body>
	<!-- ----------------- -->
	<!-- TABLE OF CONTENTS -->
	<!-- ----------------- -->
	<div th:fragment="tableOfContents(scenarioList)" class="tableOfContents mt-4 mb-5">
		<div class="list-group list-group-flush">
			<a class="list-group-item list-group-item-action" href="#welcome">Welcome to Frosthaven</a>
			<a class="list-group-item list-group-item-action" href="#party">The party</a>

			<th:block th:each="storyObject : ${storyObjectsList}" th:object="${storyObject}" th:with="outpostCount=0">
				<!-- Scenario -->
				<a th:if="*{objectType.name() == 'SCENARIO'}" class="list-group-item list-group-item-action" th:href="|#scenario_*{id}|">
					[[*{id}]] · [[*{name}]]
				</a>
				<!-- Outpost phase -->
				<th:block th:if="*{objectType.name() == 'OUTPOST'}">
					<a class="list-group-item list-group-item-action" th:href="|#outpost_*{id}|">
						Outpost phase #[[*{id}]]
					</a>
					<a class="list-group-item list-group-item-action ps-5" th:object="${storyObject.event}" th:href="|#event_*{id}|">
						[[*{id}]] · [[*{season}]] [[*{type}]] Event
					</a>
				</th:block>
				<!-- Event -->
				<a th:if="*{objectType.name() == 'EVENT'}" class="list-group-item list-group-item-action" th:href="|#event_*{id}|">
					[[*{id}]] · [[*{season}]] [[*{type}]] Event
				</a>
			</th:block>
		</div>
	</div>


	<!-- ------- -->
	<!-- WELCOME -->
	<!-- ------- -->
	<div th:fragment="welcome" id="welcome" class="welcome mt-4 mb-5">
		<h1 class="title">Welcome to Frosthaven</h1>
		<div class="text">
			[(${welcome})]
		</div>
	</div>


	<!-- ----- -->
	<!-- PARTY -->
	<!-- ----- -->
	<div th:fragment="party" id="party" class="party mt-4 mb-5">
		<h1 class="title">The party</h1>
		<div th:each="character : ${party.characters}" th:object="${character}" class="character">
			<h2 class="title">[[*{name}]]</h2>
			<div class="mat">
				<img th:src="@{img/characters/__*{nameId}__.png}">
				<img class="mt-2" th:src="@{img/characters/__*{nameId}___back.png}">
			</div>
			<div th:if="*{background}" class="background">
				[(*{background})]
			</div>
			<div th:if="*{personalQuest}" class="personalQuest">
				<img th:src="@{img/personalQuests/__*{personalQuest}__.png}">
			</div>
		</div>
	</div>


	<!-- ------------- -->
	<!-- OUTPOST PHASE -->
	<!-- ------------- -->
	<div th:fragment="outpost(outpost)" th:object="${outpost}" th:id="|outpost_*{id}|" class="outpost">
		<!-- Title -->
		<h1 class="title">
			Outpost phase <span class="number">#[[*{id}]]</span>
		</h1>

		<!-- Event -->
		<th:block th:replace="~{fragments/event :: event(*{event})}"></th:block>

		<!-- Downtime -->
		<div th:if="*{levelUp}" class="downtime mt-4">
			<h2 class="title">Downtime</h2>
			<div class="levelUp">
				<div th:each="character : *{levelUp}">
					<strong>[[${character.name}]]</strong> levels up to <strong>level [[${character.level}]]</strong>.
				</div>
			</div>
		</div>
		
		<!-- Construction -->
		<div class="construction mt-4">
			<h2 class="title">Construction</h2>
			<div class="build">
				<div th:each="building : *{build}" class="building">
					<div class="text">
						<strong>[[${building.name}]]</strong> is built<th:block th:if="${building.level}"> at <strong>level [[${building.level}]]</strong></th:block>.
					</div>
					<img th:with="imgName = ${building.nameId} + ${building.level != 0 ? building.level : ''}"
					     th:src="@{img/buildings/__${imgName}__.png}">
				</div>
			</div>
			<div class="upgrade">
				<div th:each="building : *{upgrade}" class="building">
					<div class="text">
						<strong>[[${building.name}]]</strong> is upgraded to <strong>level [[${building.level}]]</strong>.
					</div>
					<img th:src="@{img/buildings/__${building.nameId}____${building.level}__.png}">
				</div>
			</div>
		</div>
	</div>
</body>
</html>